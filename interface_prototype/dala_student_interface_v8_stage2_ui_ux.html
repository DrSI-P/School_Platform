
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DALA Learning Adventure! - Stage 2 UI/UX</title>
    <style>
        @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Fredoka+One&display=swap");

        body {
            font-family: "Poppins", sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #4A4A4A;
            line-height: 1.7;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding-top: 30px;
            padding-bottom: 30px;
        }
        .container {
            background-color: rgba(255, 255, 255, 0.95);
            padding: 30px 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            max-width: 850px;
            width: 90%;
            margin: 20px auto;
        }
        h1 {
            font-family: "Fredoka One", cursive;
            color: #5e35b1;
            text-align: center;
            font-size: 2.8em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        h2 {
            font-family: "Fredoka One", cursive;
            color: #00796b;
            border-bottom: 3px dashed #764ba2;
            padding-bottom: 10px;
            margin-top: 35px;
            font-size: 1.8em;
            display: flex;
            align-items: center;
        }
        h3 {
            font-family: "Poppins", sans-serif;
            font-weight: 600;
            color: #1e88e5;
            margin-top: 25px;
            font-size: 1.3em;
        }
        h4 {
            font-family: "Poppins", sans-serif;
            font-weight: 600;
            color: #3949ab; /* Slightly different color for H4 */
            margin-top: 20px;
            font-size: 1.1em;
        }
        .section {
            margin-bottom: 35px;
            padding: 25px;
            background-color: #f7f9fc;
            border: 1px solid #e0e0e0;
            border-radius: 15px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .section:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }
        .button {
            background-image: linear-gradient(to right, #ff7e5f, #feb47b);
            color: white;
            padding: 14px 25px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin-right: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .button:hover {
            background-image: linear-gradient(to right, #feb47b, #ff7e5f);
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
            transform: translateY(-2px);
        }
        .button[disabled] {
            background-image: none;
            background-color: #cccccc;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }
        ul {
            list-style-type: none;
            padding-left: 0;
        }
        li {
            background-color: #ffffff;
            margin-bottom: 12px;
            padding: 18px;
            border-radius: 10px;
            border-left: 6px solid #66bb6a;
            box-shadow: 0 3px 8px rgba(0,0,0,0.07);
            transition: transform 0.2s ease;
        }
        li:hover {
            transform: translateX(5px);
        }
        .lo-title {
            font-weight: 700;
            color: #3949ab;
            font-size: 1.15em;
            margin-bottom: 5px;
        }
        .content-title {
            margin-left: 15px;
            color: #546e7a;
            font-size: 1em;
        }
        .content-title em {
            color: #78909c;
            font-size: 0.9em;
        }
        pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            background-color: #f5f5f5;
            padding: 18px;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
            font-size: 0.95em;
            color: #37474f;
            max-height: 250px;
            overflow-y: auto;
        }
        strong { color: #ef5350; }
        em { color: #26a69a; }
        .section-icon {
            margin-right: 12px;
            font-size: 1.5em;
            color: #7e57c2;
        }
        .diagnostic-task-result {
            background-color: #e8f5e9;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            border-left: 5px solid #4caf50;
        }
        .diagnostic-task-result p { margin: 5px 0; }

        /* Styles for new UI/UX elements */
        .interactive-selection-area label {
            display: block;
            margin-bottom: 8px;
            padding: 10px;
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s ease, border-color 0.2s ease;
        }
        .interactive-selection-area label:hover {
            background-color: #f0f4f8;
            border-color: #00796b;
        }
        .interactive-selection-area input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.2);
        }
        .interactive-selection-area input[type="text"],
        .goal-input-area textarea {
            width: calc(100% - 22px); /* Account for padding */
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-family: "Poppins", sans-serif;
            font-size: 1em;
            margin-top: 5px;
        }
        .selected-items-display {
            margin-top: 15px;
            padding: 15px;
            background-color: #e3f2fd;
            border-radius: 8px;
            border: 1px dashed #90caf9;
        }
        .selected-items-display p em {
            color: #546e7a;
        }
        .selected-item-tag {
            display: inline-block;
            background-color: #66bb6a;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            margin-right: 8px;
            margin-bottom: 8px;
            font-size: 0.9em;
        }
        .goal-input-area textarea {
            resize: vertical;
            min-height: 60px;
        }

        #gameCanvas {
            border: 3px dashed #764ba2;
            background-color: #fafafa;
            border-radius: 12px;
            cursor: crosshair;
            margin-top: 15px;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        .game-info {
            font-size: 1.2em;
            color: #004d40;
            margin-bottom: 10px;
            text-align: center;
            font-weight: 600;
        }
        #gameMessage {
            text-align: center;
            font-weight: 600;
            color: #d32f2f;
            min-height: 20px;
            margin-top: 10px;
        }
        .game-section .button {
             display: block;
             margin: 20px auto 0 auto;
        }
        .accessibility-controls h3 .section-icon { color: #42a5f5; }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ú® DALA Learning Adventure! ‚ú®</h1>
        
        <div class="section task-section">
            <h2><span class="section-icon">üöÄ</span>Let"s Get Started!</h2>
            <p>Tell us a little about yourself so we can make learning super fun and just right for you!</p>
            
            <h3>Your Learning Superpowers (Simulated)</h3>
            <p>Visual Task Preference: <em>visual</em></p>
            <p>Textual Task Preference: <em>detailed_text</em></p>
            
            <h3>Your Awesome Interests (Simulated)</h3>
            <p>Selected Interests: <strong>Dinosaurs, Ancient Civilizations, Space Exploration, Creative Writing</strong></p>
            
            <!-- Interactive Struggle Areas Section -->
            <h3><span class="section-icon">üí™</span>My Focus Areas</h3>
            <p>Everyone has things they find a bit tricky or want to get better at! What are some areas where you"d like a little extra help or practice? Choose a few that feel right for you (up to 3).</p>
            <div id="struggleAreasSelection" class="interactive-selection-area">
                
            <label>
                <input type="checkbox" name="struggle_areas" value="Understanding fractions"> 
                ‚ûó Understanding fractions
            </label>
            <label>
                <input type="checkbox" name="struggle_areas" value="Writing long essays"> 
                üìù Writing long essays
            </label>
            <label>
                <input type="checkbox" name="struggle_areas" value="Remembering historical dates"> 
                üìÖ Remembering historical dates
            </label>
            <label>
                <input type="checkbox" name="struggle_areas" value="Solving word problems in math"> 
                üßÆ Solving word problems in math
            </label>
            <label>
                <input type="checkbox" name="struggle_areas" value="Staying focused during lectures"> 
                üéØ Staying focused during lectures
            </label>
            <label>
                <input type="checkbox" name="struggle_areas" value="Public speaking"> 
                üó£Ô∏è Public speaking
            </label>
            <label>
                <input type="checkbox" name="struggle_areas" value="Learning new vocabulary"> 
                üìö Learning new vocabulary
            </label>
            <label>
                <input type="checkbox" name="struggle_areas" value="Organizing my study time"> 
                üìã Organizing my study time
            </label>
            </div>
            <div class="struggle-area-other" style="margin-top:15px;">
                <label for="otherStruggle">Something else? Tell us:</label>
                <input type="text" id="otherStruggleInput" name="otherStruggle" placeholder="e.g., Speaking in front of class">
            </div>
            <h4>Your Chosen Focus Areas:</h4>
            <div id="selectedStrugglesDisplay" class="selected-items-display">
                <p><em>You haven"t selected any focus areas yet. Click on the items above or type one in!</em></p>
            </div>
        </div>

        <!-- Interactive Learning Goals Section -->
        <div class="section goals-section">
            <h2><span class="section-icon">üéØ</span>My Learning Mission!</h2>
            <p>Setting goals helps us on our learning adventure! What"s one big thing you"re excited to work towards with DALA?</p>
            <div class="goal-input-area">
                <textarea id="learningGoalInput" rows="3" placeholder="e.g., Get super good at my times tables, Write an amazing story, Understand how planets work."></textarea>
                <button class="button" id="setLearningGoalButton" style="margin-top:10px;">Set My Mission!</button>
            </div>
            <h4>Your Current Mission:</h4>
            <div id="learningGoalDisplay" class="selected-items-display">
                <p><em>Your mission will appear here once you set it!</em></p>
            </div>
        </div>

        <!-- Stage 2 HLP Sophisticated Diagnostic Mini-Tasks -->
        <div class="section diagnostic-section">
            <h2><span class="section-icon">üß†</span> Brain Boosters! (Stage 2 HLP)</h2>
            <p>Let"s try some new fun activities to understand your amazing brain even better!</p>
            
            <h3>Story Weaver Task (Simulated Results)</h3>
            <div class="diagnostic-task-result">
                <p><strong>Task:</strong> You were asked to arrange 3 story parts into the correct order. Let&#x27;s see how you did!</p>
                <p><em>Panels to arrange:</em> 3</p>
                <p><em>Your sequence (simulated):</em> 2, 1, 3</p>
                <p><em>Time taken:</em> 52.5s, <em>Accuracy:</em> 60%, <em>Attempts:</em> 1</p>
            </div>

            <h3>Mind Mapper Task (Simulated Results)</h3>
            <div class="diagnostic-task-result">
                <p><strong>Task:</strong> You explored ideas around the concept: 	Rainforest	. You came up with 3 related ideas!</p>
                <p><em>Central Concept:</em> Rainforest</p>
                <p><em>Ideas Generated:</em> 3</p>
                <p><em>Keywords (simulated):</em> mummies, exploration, pharaohs</p>
                <p><em>Connections Made:</em> 1</p>
            </div>

            <h3>Sound Sculptor Task (Simulated Results)</h3>
            <div class="diagnostic-task-result">
                <p><strong>Task:</strong> You listened to a sequence of 4 sounds and tried to sculpt them back. Great effort!</p>
                <p><em>Sequence Length:</em> 4</p>
                <p><em>Accuracy:</em> 100%, <em>Attempts:</em> 1</p>
                <p><em>Complexity Level Reached:</em> 3</p>
            </div>
        </div>

        <div class="section profile-section">
            <h2><span class="section-icon">üßë‚Äçüéì</span>Your Unique Learner Profile (Updated)</h2>
            <pre>LearnerProfile(student_id=	student_008	, preferences=	{&#x27;visual_task_1&#x27;: &#x27;visual&#x27;, &#x27;textual_task_1&#x27;: &#x27;detailed_text&#x27;}	, interests=	[&#x27;Dinosaurs&#x27;, &#x27;Ancient Civilizations&#x27;, &#x27;Space Exploration&#x27;, &#x27;Creative Writing&#x27;]	, struggle_areas=	[&#x27;Learning new vocabulary&#x27;, &#x27;Solving word problems in math&#x27;]	, cognitive_metrics=	{&#x27;story_weaver&#x27;: {&#x27;num_panels&#x27;: 3, &#x27;time_taken_sec&#x27;: 52.5, &#x27;accuracy&#x27;: 0.6, &#x27;attempts&#x27;: 1, &#x27;chosen_sequence&#x27;: [2, 1, 3]}, &#x27;mind_mapper&#x27;: {&#x27;central_concept&#x27;: &#x27;Rainforest&#x27;, &#x27;ideas_generated&#x27;: 3, &#x27;keywords&#x27;: [&#x27;mummies&#x27;, &#x27;exploration&#x27;, &#x27;pharaohs&#x27;], &#x27;connections_made&#x27;: 1}, &#x27;sound_sculptor&#x27;: {&#x27;sequence_length&#x27;: 4, &#x27;accuracy&#x27;: 1.0, &#x27;attempts&#x27;: 1, &#x27;complexity_level&#x27;: 3}}	)</pre>
        </div>

        <div class="section pathway-section">
            <h2><span class="section-icon">üó∫Ô∏è</span>Your Personalized Learning Pathway</h2>
            <ul><li><div class="lo-title">üìö Learning Objective 1: Recall multiplication and division facts for multiplication tables up to 12 √ó 12.</div><div class="content-title">üí° Activity: Times Tables Practice Game (Up to 12x12) (Format: game)</div><p><em>Play: Times Tables Practice Game (Up to 12x12) (Imagine a game here!)</em></p></li><li><div class="lo-title">üìö Learning Objective 2: Use place value, known and derived facts to multiply and divide mentally, including: multiplying by 0 and 1; dividing by 1; multiplying together three numbers.</div><div class="content-title">üí° Activity: Video: Understanding Multiplication by 0 and 1 (Format: video)</div><p><em>Watch: <a href="#" target="_blank">Video: Understanding Multiplication by 0 and 1</a></em></p></li><li><div class="lo-title">üìö Learning Objective 3: Recognise and use factor pairs and commutativity in mental calculations.</div><div class="content-title">üí° Activity: Worksheet: Factor Pairs Fun (Format: worksheet_pdf)</div><p><em>Download: <a href="#" target="_blank">Worksheet</a></em></p></li></ul>
        </div>

        <div class="section game-section">
            <h2><span class="section-icon">üåü</span>Reward Zone: Star Collector!</h2>
            <p style="text-align:center;">Awesome work! Time for a quick, fun game to celebrate your progress!</p>
            <div class="game-info">
                <span>Score: <span id="score">0</span></span> ‚ú® 
                <span>Time Left: <span id="timeLeft">30</span>s</span>
            </div>
            <canvas id="gameCanvas" width="600" height="250"></canvas>
            <p id="gameMessage"></p>
            <button class="button" id="startGameButton">Play Star Collector!</button>
        </div>

        <div class="section accessibility-controls">
            <h3><span class="section-icon">‚ôø</span>Accessibility Tools (Coming Soon!)</h3>
            <p style="text-align:center;"><button class="button" disabled>üéôÔ∏è Voice Input</button> 
            <button class="button" disabled>üéß Text-to-Speech</button></p>
            <p style="text-align:center; font-style:italic;">We"re working hard to make learning accessible for everyone!</p>
        </div>

    </div>

    <script>
    document.addEventListener("DOMContentLoaded", function() {
        // Struggle Areas Interaction
        const struggleAreasSelection = document.getElementById("struggleAreasSelection");
        const otherStruggleInput = document.getElementById("otherStruggleInput");
        const selectedStrugglesDisplay = document.getElementById("selectedStrugglesDisplay");
        const MAX_STRUGGLES = 3;
        let currentSelectedStruggles = [];

        function updateSelectedStrugglesDisplay() {
            selectedStrugglesDisplay.innerHTML = ""; // Clear previous
            if (currentSelectedStruggles.length === 0) {
                selectedStrugglesDisplay.innerHTML = "<p><em>You haven"t selected any focus areas yet. Click on the items above or type one in!</em></p>";
            } else {
                currentSelectedStruggles.forEach(struggle => {
                    const tag = document.createElement("span");
                    tag.className = "selected-item-tag";
                    tag.textContent = struggle;
                    selectedStrugglesDisplay.appendChild(tag);
                });
            }
        }

        if (struggleAreasSelection) {
            struggleAreasSelection.addEventListener("change", function(event) {
                if (event.target.type === "checkbox") {
                    if (event.target.checked) {
                        if (currentSelectedStruggles.length < MAX_STRUGGLES) {
                            currentSelectedStruggles.push(event.target.value);
                        } else {
                            event.target.checked = false; // Prevent checking more than max
                            alert("You can select up to " + MAX_STRUGGLES + " focus areas.");
                        }
                    } else {
                        currentSelectedStruggles = currentSelectedStruggles.filter(s => s !== event.target.value);
                    }
                    updateSelectedStrugglesDisplay();
                }
            });
        }
        
        if (otherStruggleInput) {
            otherStruggleInput.addEventListener("keypress", function(event) {
                if (event.key === "Enter" && otherStruggleInput.value.trim() !== "") {
                    event.preventDefault(); // Prevent form submission if it were in a form
                    if (currentSelectedStruggles.length < MAX_STRUGGLES) {
                        const newStruggle = otherStruggleInput.value.trim();
                        if (!currentSelectedStruggles.includes(newStruggle) && !Array.from(struggleAreasSelection.querySelectorAll("input[type=checkbox]")).some(cb => cb.value === newStruggle)) {
                           currentSelectedStruggles.push(newStruggle);
                           otherStruggleInput.value = ""; // Clear input
                           updateSelectedStrugglesDisplay();
                        } else if (currentSelectedStruggles.includes(newStruggle)){
                            alert("You've already added this focus area.");
                        } else {
                            alert("This focus area is already in the list above. Please select it.");
                        }
                    } else {
                        alert("You can select up to " + MAX_STRUGGLES + " focus areas.");
                    }
                    otherStruggleInput.value = ""; // Clear input even if not added
                }
            });
        }
        updateSelectedStrugglesDisplay(); // Initial call

        // Learning Goal Interaction
        const learningGoalInput = document.getElementById("learningGoalInput");
        const setLearningGoalButton = document.getElementById("setLearningGoalButton");
        const learningGoalDisplay = document.getElementById("learningGoalDisplay");

        if (setLearningGoalButton && learningGoalInput && learningGoalDisplay) {
            setLearningGoalButton.addEventListener("click", function() {
                const goalText = learningGoalInput.value.trim();
                if (goalText) {
                    learningGoalDisplay.innerHTML = `<p style="font-weight:bold; color:#00796b;">üöÄ $${goalText}</p>`; // Corrected JS template literal
                    learningGoalInput.value = ""; // Clear input
                } else {
                    learningGoalDisplay.innerHTML = "<p><em>Your mission will appear here once you set it! Why not type one in?</em></p>";
                    alert("Please type in your learning mission!");
                }
            });
        }

        // Game Canvas Logic (existing)
        const canvas = document.getElementById("gameCanvas");
        if (!canvas) { console.error("Game canvas not found!"); return; }
        const ctx = canvas.getContext("2d");
        const scoreDisplay = document.getElementById("score");
        const timeLeftDisplay = document.getElementById("timeLeft");
        const gameMessageDisplay = document.getElementById("gameMessage");
        const startGameButton = document.getElementById("startGameButton");

        if (!ctx || !scoreDisplay || !timeLeftDisplay || !gameMessageDisplay || !startGameButton) {
            console.error("One or more game elements are missing from the DOM.");
        }

        let score = 0; let timeLeft = 30; let gameInterval; let timerIntervalInstance; let stars = [];
        const starRadius = 12; const numStars = 12; let gameActive = false;

        function drawStar(x, y, spikes, outerRadius, innerRadius) {
            let rot = Math.PI / 2 * 3; let step = Math.PI / spikes;
            ctx.beginPath(); ctx.moveTo(x, y - outerRadius);
            for (let i = 0; i < spikes; i++) {
                ctx.lineTo(x + Math.cos(rot) * outerRadius, y + Math.sin(rot) * outerRadius); rot += step;
                ctx.lineTo(x + Math.cos(rot) * innerRadius, y + Math.sin(rot) * innerRadius); rot += step;
            }
            ctx.lineTo(x, y - outerRadius); ctx.closePath();
            ctx.fillStyle = `hsl($${Math.random() * 60 + 200}, 100%, 70%)`; // Corrected JS template literal
            ctx.beginPath(); ctx.arc(x, y, starRadius * 0.3, 0, Math.PI * 2);
            ctx.fillStyle = "rgba(255, 255, 255, 0.7)"; ctx.fill();
        }
        function createStar() { return { x: Math.random() * (canvas.width - starRadius * 2) + starRadius, y: Math.random() * -canvas.height * 0.5, speed: Math.random() * 1.5 + 0.8 }; }
        function updateStars() {
            if (!gameActive) return;
            for (let i = 0; i < stars.length; i++) {
                stars[i].y += stars[i].speed;
                if (stars[i].y > canvas.height + starRadius) { stars.splice(i, 1); i--; }
            }
            if (stars.length < numStars && Math.random() < 0.08) { stars.push(createStar()); }
        }
        function drawStars() { stars.forEach(star => drawStar(star.x, star.y, 5, starRadius, starRadius / 2)); }
        function clearCanvas() { ctx.clearRect(0, 0, canvas.width, canvas.height); }
        function gameLoop() { if (!gameActive) return; clearCanvas(); updateStars(); drawStars(); }
        
        if (startGameButton) {
            startGameButton.addEventListener("click", startGame);
        }

        function startGame() {
            if (gameActive) return;
            if (!canvas || !ctx || !scoreDisplay || !timeLeftDisplay || !gameMessageDisplay || !startGameButton) {
                 console.error("Cannot start game, critical elements missing.");
                 if(gameMessageDisplay) gameMessageDisplay.textContent = "Game cannot start, elements missing.";
                 return;
            }
            gameActive = true; score = 0; timeLeft = 30; stars = [];
            for(let i=0; i < numStars / 2; i++) { stars.push(createStar()); }
            scoreDisplay.textContent = score; timeLeftDisplay.textContent = timeLeft;
            gameMessageDisplay.textContent = "Catch those stars!";
            startGameButton.style.display = "none";
            if (gameInterval) clearInterval(gameInterval); if (timerIntervalInstance) clearInterval(timerIntervalInstance);
            gameInterval = setInterval(gameLoop, 40);
            timerIntervalInstance = setInterval(() => {
                if (!gameActive) { clearInterval(timerIntervalInstance); return; }
                timeLeft--; timeLeftDisplay.textContent = timeLeft;
                if (timeLeft <= 0) { clearInterval(timerIntervalInstance); endGame("Time Over! Score: " + score); }
            }, 1000);
        }
        function endGame(message) {
            gameActive = false; clearInterval(gameInterval);
            if(gameMessageDisplay) gameMessageDisplay.textContent = message + " Want to play again?";
            if(startGameButton) { startGameButton.style.display = "block"; startGameButton.textContent = "Play Again!"; }
        }
        if (canvas) {
            canvas.addEventListener("click", function(event) {
                if (!gameActive) return;
                const rect = canvas.getBoundingClientRect();
                const clickX = event.clientX - rect.left; const clickY = event.clientY - rect.top;
                for (let i = stars.length - 1; i >= 0; i--) {
                    const distance = Math.sqrt(Math.pow(clickX - stars[i].x, 2) + Math.pow(clickY - stars[i].y, 2));
                    if (distance < starRadius * 1.8) { 
                        score++; 
                        if(scoreDisplay) scoreDisplay.textContent = score; 
                        stars.splice(i, 1); 
                        break; 
                    }
                }
            });
        }
    });
    </script>
</body>
</html>
